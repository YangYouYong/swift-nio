<!DOCTYPE html>
<html lang="en">
  <head>
    <title>HTTPServerUpgradeHandler Class Reference</title>
    <link rel="stylesheet" type="text/css" href="../css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
    <meta charset="utf-8">
    <script src="../js/jquery.min.js" defer></script>
    <script src="../js/jazzy.js" defer></script>
    
    <script src="../js/lunr.min.js" defer></script>
    <script src="../js/typeahead.jquery.js" defer></script>
    <script src="../js/jazzy.search.js" defer></script>
  </head>
  <body>

    <a name="//apple_ref/swift/Class/HTTPServerUpgradeHandler" class="dashAnchor"></a>

    <a title="HTTPServerUpgradeHandler Class Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="../index.html">
          NIOHTTP1 Docs
        </a>
         (49% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="../search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/apple/swift-nio">
            <img class="header-icon" src="../img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="../index.html">NIOHTTP1 Reference</a>
      <img class="carat" src="../img/carat.png" />
      HTTPServerUpgradeHandler Class Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPDecoder.html">HTTPDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPRequestDecoder.html">HTTPRequestDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPRequestEncoder.html">HTTPRequestEncoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPResponseCompressor.html">HTTPResponseCompressor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPResponseCompressor/CompressionError.html">– CompressionError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPResponseDecoder.html">HTTPResponseDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPServerPipelineHandler.html">HTTPServerPipelineHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPServerProtocolErrorHandler.html">HTTPServerProtocolErrorHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/HTTPServerUpgradeHandler.html">HTTPServerUpgradeHandler</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPMethod.html">HTTPMethod</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPMethod/HasBody.html">– HasBody</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPParserError.html">HTTPParserError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPPart.html">HTTPPart</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPResponseStatus.html">HTTPResponseStatus</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPUpgradeErrors.html">HTTPUpgradeErrors</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/HTTPUpgradeEvents.html">HTTPUpgradeEvents</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/RemoveAfterUpgradeStrategy.html">RemoveAfterUpgradeStrategy</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Extensions/ChannelPipeline.html">ChannelPipeline</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Protocols/HTTPProtocolUpgrader.html">HTTPProtocolUpgrader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Protocols/_DeprecateHTTPHeaderIterator.html">_DeprecateHTTPHeaderIterator</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPHeader.html">HTTPHeader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPHeaderIndex.html">HTTPHeaderIndex</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPHeaders.html">HTTPHeaders</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPHeaders/Iterator.html">– Iterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPListHeaderIterator.html">HTTPListHeaderIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPRequestHead.html">HTTPRequestHead</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPResponseHead.html">HTTPResponseHead</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/HTTPVersion.html">HTTPVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Typealiases.html#/s:8NIOHTTP121HTTPClientRequestParta">HTTPClientRequestPart</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Typealiases.html#/s:8NIOHTTP122HTTPClientResponseParta">HTTPClientResponsePart</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Typealiases.html#/s:8NIOHTTP121HTTPServerRequestParta">HTTPServerRequestPart</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Typealiases.html#/s:8NIOHTTP122HTTPServerResponseParta">HTTPServerResponsePart</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Typealiases.html#/s:8NIOHTTP124HTTPUpgradeConfigurationa">HTTPUpgradeConfiguration</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            <h1>HTTPServerUpgradeHandler</h1>
              <div class="declaration">
                <div class="language">
                  <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">class</span> <span class="kt">HTTPServerUpgradeHandler</span> <span class="p">:</span> <span class="kt">ChannelInboundHandler</span></code></pre>

                </div>
              </div>
            <p>A server-side channel handler that receives HTTP requests and optionally performs a HTTP-upgrade.
Removes itself from the channel pipeline after the first inbound request on the connection, regardless of
whether the upgrade succeeded or not.</p>

<p>This handler behaves a bit differently from its Netty counterpart because it does not allow upgrade
on any request but the first on a connection. This is primarily to handle clients that pipeline: it&rsquo;s
sufficiently difficult to ensure that the upgrade happens at a safe time while dealing with pipelined
requests that we choose to punt on it entirely and not allow it. As it happens this is mostly fine:
the odds of someone needing to upgrade midway through the lifetime of a connection are very low.</p>

          </div>
        </section>

        <section class="section">
          <div class="section-content">
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO21ChannelInboundHandlerP0C2InQa"></a>
                    <a name="//apple_ref/swift/Alias/InboundIn" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO21ChannelInboundHandlerP0C2InQa">InboundIn</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">InboundIn</span> <span class="o">=</span> <span class="kt"><a href="../Typealiases.html#/s:8NIOHTTP121HTTPServerRequestParta">HTTPServerRequestPart</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO21ChannelInboundHandlerP0C3OutQa"></a>
                    <a name="//apple_ref/swift/Alias/InboundOut" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO21ChannelInboundHandlerP0C3OutQa">InboundOut</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">InboundOut</span> <span class="o">=</span> <span class="kt"><a href="../Typealiases.html#/s:8NIOHTTP121HTTPServerRequestParta">HTTPServerRequestPart</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO23_EmittingChannelHandlerP11OutboundOutQa"></a>
                    <a name="//apple_ref/swift/Alias/OutboundOut" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO23_EmittingChannelHandlerP11OutboundOutQa">OutboundOut</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">OutboundOut</span> <span class="o">=</span> <span class="kt"><a href="../Typealiases.html#/s:8NIOHTTP122HTTPServerResponseParta">HTTPServerResponsePart</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8NIOHTTP124HTTPServerUpgradeHandlerC9upgraders11httpEncoder0F7Decoder017upgradeCompletionD0ACSayAA20HTTPProtocolUpgrader_pG_AA012HTTPResponseG0CSgAA011HTTPRequestH0CSgy3NIO07ChannelD7ContextCctcfc"></a>
                    <a name="//apple_ref/swift/Method/init(upgraders:httpEncoder:httpDecoder:upgradeCompletionHandler:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8NIOHTTP124HTTPServerUpgradeHandlerC9upgraders11httpEncoder0F7Decoder017upgradeCompletionD0ACSayAA20HTTPProtocolUpgrader_pG_AA012HTTPResponseG0CSgAA011HTTPRequestH0CSgy3NIO07ChannelD7ContextCctcfc">init(upgraders:httpEncoder:httpDecoder:upgradeCompletionHandler:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Create a <code>HTTPServerUpgradeHandler</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">@available(*, deprecated, message: "Please use init(upgraders:httpEncoder:extraHTTPHandlers:upgradeCompletionHandler:﹚")</span>
<span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="nv">upgraders</span><span class="p">:</span> <span class="p">[</span><span class="kt"><a href="../Protocols/HTTPProtocolUpgrader.html">HTTPProtocolUpgrader</a></span><span class="p">],</span> <span class="nv">httpEncoder</span><span class="p">:</span> <span class="kt"><a href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a></span><span class="p">?,</span> <span class="nv">httpDecoder</span><span class="p">:</span> <span class="kt"><a href="../Classes/HTTPRequestDecoder.html">HTTPRequestDecoder</a></span><span class="p">?,</span> <span class="nv">upgradeCompletionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">ChannelHandlerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>upgraders</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>All <code><a href="../Protocols/HTTPProtocolUpgrader.html">HTTPProtocolUpgrader</a></code> objects that this pipeline will be able
to use to handle HTTP upgrade.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>httpEncoder</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The <code><a href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a></code> encoding responses from this handler and which will
be removed from the pipeline once the upgrade response is sent. This is used mostly to ensure
that the pipeline will be in a clean state after upgrade. Pass <code>nil</code> to this parameter if for any
reason you want to keep the <code><a href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a></code> in the pipeline after upgrade.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>httpDecoder</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The <code><a href="../Classes/HTTPRequestDecoder.html">HTTPRequestDecoder</a></code> decoding responses that are passed to this handler.
This is necessary to ensure that no further data is parsed as HTTP when we attempt an upgrade.
Pass <code>nil</code> to this parameter if for any reason you want to keep the <code><a href="../Classes/HTTPRequestDecoder.html">HTTPRequestDecoder</a></code> in
the pipeline after upgrade.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>upgradeCompletionHandler</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>A block that will be fired when HTTP upgrade is complete.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:8NIOHTTP124HTTPServerUpgradeHandlerC9upgraders11httpEncoder17extraHTTPHandlers017upgradeCompletionD0ACSayAA20HTTPProtocolUpgrader_pG_AA012HTTPResponseG0CSay3NIO07ChannelD0_pGyAL0pD7ContextCctcfc"></a>
                    <a name="//apple_ref/swift/Method/init(upgraders:httpEncoder:extraHTTPHandlers:upgradeCompletionHandler:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:8NIOHTTP124HTTPServerUpgradeHandlerC9upgraders11httpEncoder17extraHTTPHandlers017upgradeCompletionD0ACSayAA20HTTPProtocolUpgrader_pG_AA012HTTPResponseG0CSay3NIO07ChannelD0_pGyAL0pD7ContextCctcfc">init(upgraders:httpEncoder:extraHTTPHandlers:upgradeCompletionHandler:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Create a <code>HTTPServerUpgradeHandler</code>.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="nv">upgraders</span><span class="p">:</span> <span class="p">[</span><span class="kt"><a href="../Protocols/HTTPProtocolUpgrader.html">HTTPProtocolUpgrader</a></span><span class="p">],</span> <span class="nv">httpEncoder</span><span class="p">:</span> <span class="kt"><a href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a></span><span class="p">,</span> <span class="nv">extraHTTPHandlers</span><span class="p">:</span> <span class="p">[</span><span class="kt">ChannelHandler</span><span class="p">],</span> <span class="nv">upgradeCompletionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">ChannelHandlerContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>upgraders</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>All <code><a href="../Protocols/HTTPProtocolUpgrader.html">HTTPProtocolUpgrader</a></code> objects that this pipeline will be able
to use to handle HTTP upgrade.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>httpEncoder</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The <code><a href="../Classes/HTTPResponseEncoder.html">HTTPResponseEncoder</a></code> encoding responses from this handler and which will
be removed from the pipeline once the upgrade response is sent. This is used to ensure
that the pipeline will be in a clean state after upgrade.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>extraHTTPHandlers</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>Any other handlers that are directly related to handling HTTP. At the very least
this should include the <code><a href="../Classes/HTTPDecoder.html">HTTPDecoder</a></code>, but should also include any other handler that cannot tolerate
receiving non-HTTP data.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>upgradeCompletionHandler</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>A block that will be fired when HTTP upgrade is complete.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO22_ChannelInboundHandlerP11channelRead3ctx4datayAA0bD7ContextC_AA6NIOAnyVtF"></a>
                    <a name="//apple_ref/swift/Method/channelRead(ctx:data:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO22_ChannelInboundHandlerP11channelRead3ctx4datayAA0bD7ContextC_AA6NIOAnyVtF">channelRead(ctx:data:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">func</span> <span class="nf">channelRead</span><span class="p">(</span><span class="nv">ctx</span><span class="p">:</span> <span class="kt">ChannelHandlerContext</span><span class="p">,</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">NIOAny</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="https://github.com/apple/swift-nio" target="_blank" rel="external">SwiftNIO Team</a>. All rights reserved. (Last updated: 2019-04-15)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
