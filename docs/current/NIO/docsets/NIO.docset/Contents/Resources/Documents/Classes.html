<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Classes  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>

    <a name="//apple_ref/swift/Section/Classes" class="dashAnchor"></a>

    <a title="Classes  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          NIO Docs
        </a>
         (90% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/apple/swift-nio">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="dash-feed://https%3A%2F%2Fapple%2Egithub%2Eio%2Fswift%2Dnio%2Fdocs%2F2%2E0%2E1%2Fdocsets%2FNIO%2Exml">
            <img class="header-icon" src="img/dash.png"/>
            Install in Dash
          </a>
        </p>
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">NIO Reference</a>
      <img class="carat" src="img/carat.png" />
      Classes  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/AcceptBackoffHandler.html">AcceptBackoffHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/BackPressureHandler.html">BackPressureHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ByteToMessageHandler.html">ByteToMessageHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChannelHandlerContext.html">ChannelHandlerContext</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChannelHandlerContext.html#/s:3NIO21ChannelHandlerContextC12RemovalTokenV">– RemovalToken</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChannelPipeline.html">ChannelPipeline</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ChannelPipeline/Position.html">– Position</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ClientBootstrap.html">ClientBootstrap</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DatagramBootstrap.html">DatagramBootstrap</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EmbeddedChannel.html">EmbeddedChannel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EmbeddedChannel/LeftOverState.html">– LeftOverState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EmbeddedChannel/BufferState.html">– BufferState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EmbeddedChannel/WrongTypeError.html">– WrongTypeError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EmbeddedEventLoop.html">EmbeddedEventLoop</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/EventLoopFuture.html">EventLoopFuture</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/IdleStateHandler.html">IdleStateHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/IdleStateHandler/IdleStateEvent.html">– IdleStateEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MessageToByteHandler.html">MessageToByteHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MultiThreadedEventLoopGroup.html">MultiThreadedEventLoopGroup</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NIOFileHandle.html">NIOFileHandle</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NIONetworkInterface.html">NIONetworkInterface</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NIOThreadPool.html">NIOThreadPool</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/NIOThreadPool/WorkItemState.html">– WorkItemState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/RepeatedTask.html">RepeatedTask</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ServerBootstrap.html">ServerBootstrap</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ThreadSpecificVariable.html">ThreadSpecificVariable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ByteToMessageDecoderError.html">ByteToMessageDecoderError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ChannelError.html">ChannelError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ChannelEvent.html">ChannelEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/ChannelPipelineError.html">ChannelPipelineError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/CloseMode.html">CloseMode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DecodingState.html">DecodingState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/Endianness.html">Endianness</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/EventLoopError.html">EventLoopError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/IOData.html">IOData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SocketAddress.html">SocketAddress</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SocketAddress/IPv4Address.html">– IPv4Address</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SocketAddress/IPv6Address.html">– IPv6Address</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SocketAddress/UnixSocketAddress.html">– UnixSocketAddress</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SocketAddressError.html">SocketAddressError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/System.html">System</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ByteToMessageDecoder.html">ByteToMessageDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Channel.html">Channel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelCore.html">ChannelCore</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelHandler.html">ChannelHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelInboundInvoker.html">ChannelInboundInvoker</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:3NIO14ChannelInvokerP">ChannelInvoker</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelOption.html">ChannelOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/ChannelOutboundInvoker.html">ChannelOutboundInvoker</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/EventLoop.html">EventLoop</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/EventLoopGroup.html">EventLoopGroup</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/FileDescriptor.html">FileDescriptor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MessageToByteEncoder.html">MessageToByteEncoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MulticastChannel.html">MulticastChannel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/RecvByteBufferAllocator.html">RecvByteBufferAllocator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/RemovableChannelHandler.html">RemovableChannelHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/Resolver.html">Resolver</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/SocketOptionProvider.html">SocketOptionProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/WriteObservingByteToMessageDecoder.html">WriteObservingByteToMessageDecoder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/_ChannelInboundHandler.html">_ChannelInboundHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/_ChannelOutboundHandler.html">_ChannelOutboundHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/_EmittingChannelHandler.html">_EmittingChannelHandler</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AdaptiveRecvByteBufferAllocator.html">AdaptiveRecvByteBufferAllocator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AddressedEnvelope.html">AddressedEnvelope</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AllocatorOption.html">AllocatorOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AllowRemoteHalfClosureOption.html">AllowRemoteHalfClosureOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AutoReadOption.html">AutoReadOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/BacklogOption.html">BacklogOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ByteBuffer.html">ByteBuffer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ByteBufferAllocator.html">ByteBufferAllocator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ByteBufferView.html">ByteBufferView</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ChannelOptions.html">ChannelOptions</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ChannelOptions/Storage.html">– Storage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ChannelShouldQuiesceEvent.html">ChannelShouldQuiesceEvent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CircularBuffer.html">CircularBuffer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/CircularBuffer/Index.html">– Index</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ConnectTimeoutOption.html">ConnectTimeoutOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DatagramVectorReadMessageCountOption.html">DatagramVectorReadMessageCountOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EventLoopIterator.html">EventLoopIterator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/EventLoopPromise.html">EventLoopPromise</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FileRegion.html">FileRegion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FixedSizeRecvByteBufferAllocator.html">FixedSizeRecvByteBufferAllocator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/IOError.html">IOError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/IOError/FailureDescription.html">– FailureDescription</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MarkedCircularBuffer.html">MarkedCircularBuffer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MaxMessagesPerReadOption.html">MaxMessagesPerReadOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NIOAny.html">NIOAny</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NIOConnectionError.html">NIOConnectionError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NIODeadline.html">NIODeadline</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NonBlockingFileIO.html">NonBlockingFileIO</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/NonBlockingFileIO/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RecvAllocatorOption.html">RecvAllocatorOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Scheduled.html">Scheduled</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SingleConnectionFailure.html">SingleConnectionFailure</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SocketOption.html">SocketOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TimeAmount.html">TimeAmount</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/WriteBufferWaterMark.html">WriteBufferWaterMark</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/WriteBufferWaterMarkOption.html">WriteBufferWaterMarkOption</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/WriteSpinOption.html">WriteSpinOption</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:3NIO20ChannelDuplexHandlera">ChannelDuplexHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/SocketOptionLevel">SocketOptionLevel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:3NIO17SocketOptionLevela">SocketOptionLevel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:3NIO16SocketOptionNamea">SocketOptionName</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/SocketOptionValue">SocketOptionValue</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:3NIO17SocketOptionValuea">SocketOptionValue</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            <h1>Classes</h1>
            <p>The following classes are available globally.</p>

          </div>
        </section>

        <section class="section">
          <div class="section-content">
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO15ServerBootstrapC"></a>
                    <a name="//apple_ref/swift/Class/ServerBootstrap" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO15ServerBootstrapC">ServerBootstrap</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>ServerBootstrap</code> is an easy way to bootstrap a <code>ServerSocketChannel</code> when creating network servers.</p>

<p>Example:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">group</span> <span class="o">=</span> <span class="kt">MultiThreadedEventLoopGroup</span><span class="p">(</span><span class="nv">numberOfThreads</span><span class="p">:</span> <span class="kt">System</span><span class="o">.</span><span class="n">coreCount</span><span class="p">)</span>
    <span class="k">defer</span> <span class="p">{</span>
        <span class="k">try!</span> <span class="n">group</span><span class="o">.</span><span class="nf">syncShutdownGracefully</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">bootstrap</span> <span class="o">=</span> <span class="kt">ServerBootstrap</span><span class="p">(</span><span class="nv">group</span><span class="p">:</span> <span class="n">group</span><span class="p">)</span>
        <span class="c1">// Specify backlog and enable SO_REUSEADDR for the server itself</span>
        <span class="o">.</span><span class="nf">serverChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="n">backlog</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">256</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">serverChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="nf">socket</span><span class="p">(</span><span class="kt">SocketOptionLevel</span><span class="p">(</span><span class="kt">SOL_SOCKET</span><span class="p">),</span> <span class="kt">SO_REUSEADDR</span><span class="p">),</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1">// Set the handlers that are applied to the accepted child `Channel`s.</span>
        <span class="o">.</span><span class="n">childChannelInitializer</span> <span class="p">{</span> <span class="n">channel</span> <span class="k">in</span>
            <span class="c1">// Ensure we don't read faster then we can write by adding the BackPressureHandler into the pipeline.</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="kt">BackPressureHandler</span><span class="p">())</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="p">()</span> <span class="k">in</span>
                <span class="c1">// make sure to instantiate your `ChannelHandlers` inside of</span>
                <span class="c1">// the closure as it will be invoked once per connection.</span>
                <span class="n">channel</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="kt">MyChannelHandler</span><span class="p">())</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Enable TCP_NODELAY and SO_REUSEADDR for the accepted Channels</span>
        <span class="o">.</span><span class="nf">childChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="nf">socket</span><span class="p">(</span><span class="kt">IPPROTO_TCP</span><span class="p">,</span> <span class="kt">TCP_NODELAY</span><span class="p">),</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">childChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="nf">socket</span><span class="p">(</span><span class="kt">SocketOptionLevel</span><span class="p">(</span><span class="kt">SOL_SOCKET</span><span class="p">),</span> <span class="kt">SO_REUSEADDR</span><span class="p">),</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">childChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="n">maxMessagesPerRead</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">16</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">childChannelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="n">recvAllocator</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">AdaptiveRecvByteBufferAllocator</span><span class="p">())</span>
    <span class="k">let</span> <span class="nv">channel</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">bootstrap</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">host</span><span class="p">:</span> <span class="n">host</span><span class="p">,</span> <span class="nv">port</span><span class="p">:</span> <span class="n">port</span><span class="p">)</span><span class="o">.</span><span class="nf">wait</span><span class="p">()</span>
    <span class="cm">/* the server will now be accepting connections */</span>

    <span class="k">try!</span> <span class="n">channel</span><span class="o">.</span><span class="n">closeFuture</span><span class="o">.</span><span class="nf">wait</span><span class="p">()</span> <span class="c1">// wait forever as we never close the Channel</span>
</code></pre>

<p>The <code><a href="Classes/EventLoopFuture.html">EventLoopFuture</a></code> returned by <code>bind</code> will fire with a <code>ServerSocketChannel</code>. This is the channel that owns the listening socket.
Each time it accepts a new connection it will fire a <code>SocketChannel</code> through the <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> via <code>fireChannelRead</code>: as a result,
the <code>ServerSocketChannel</code> operates on <code><a href="Protocols/Channel.html">Channel</a></code>s as inbound messages. Outbound messages are not supported on a <code>ServerSocketChannel</code>
which means that each write attempt will fail.</p>

<p>Accepted <code>SocketChannel</code>s operate on <code><a href="Structs/ByteBuffer.html">ByteBuffer</a></code> as inbound data, and <code><a href="Enums/IOData.html">IOData</a></code> as outbound data.</p>

                        <a href="Classes/ServerBootstrap.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ServerBootstrap</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO15ClientBootstrapC"></a>
                    <a name="//apple_ref/swift/Class/ClientBootstrap" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO15ClientBootstrapC">ClientBootstrap</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>ClientBootstrap</code> is an easy way to bootstrap a <code>SocketChannel</code> when creating network clients.</p>

<p>Usually you re-use a <code>ClientBootstrap</code> once you set it up and called <code>connect</code> multiple times on it.
This way you ensure that the same <code><a href="Protocols/EventLoop.html">EventLoop</a></code>s will be shared across all your connections.</p>

<p>Example:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">group</span> <span class="o">=</span> <span class="kt">MultiThreadedEventLoopGroup</span><span class="p">(</span><span class="nv">numberOfThreads</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">defer</span> <span class="p">{</span>
        <span class="k">try!</span> <span class="n">group</span><span class="o">.</span><span class="nf">syncShutdownGracefully</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">bootstrap</span> <span class="o">=</span> <span class="kt">ClientBootstrap</span><span class="p">(</span><span class="nv">group</span><span class="p">:</span> <span class="n">group</span><span class="p">)</span>
        <span class="c1">// Enable SO_REUSEADDR.</span>
        <span class="o">.</span><span class="nf">channelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="nf">socket</span><span class="p">(</span><span class="kt">SocketOptionLevel</span><span class="p">(</span><span class="kt">SOL_SOCKET</span><span class="p">),</span> <span class="kt">SO_REUSEADDR</span><span class="p">),</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">channelInitializer</span> <span class="p">{</span> <span class="n">channel</span> <span class="k">in</span>
            <span class="c1">// always instantiate the handler _within_ the closure as</span>
            <span class="c1">// it may be called multiple times (for example if the hostname</span>
            <span class="c1">// resolves to both IPv4 and IPv6 addresses, cf. Happy Eyeballs).</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="kt">MyChannelHandler</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="k">try!</span> <span class="n">bootstrap</span><span class="o">.</span><span class="nf">connect</span><span class="p">(</span><span class="nv">host</span><span class="p">:</span> <span class="s">"example.org"</span><span class="p">,</span> <span class="nv">port</span><span class="p">:</span> <span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="nf">wait</span><span class="p">()</span>
    <span class="cm">/* the Channel is now connected */</span>
</code></pre>

<p>The connected <code>SocketChannel</code> will operate on <code><a href="Structs/ByteBuffer.html">ByteBuffer</a></code> as inbound and on <code><a href="Enums/IOData.html">IOData</a></code> as outbound messages.</p>

                        <a href="Classes/ClientBootstrap.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ClientBootstrap</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO17DatagramBootstrapC"></a>
                    <a name="//apple_ref/swift/Class/DatagramBootstrap" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO17DatagramBootstrapC">DatagramBootstrap</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>DatagramBootstrap</code> is an easy way to bootstrap a <code>DatagramChannel</code> when creating datagram clients
and servers.</p>

<p>Example:</p>
<pre class="highlight swift"><code>    <span class="k">let</span> <span class="nv">group</span> <span class="o">=</span> <span class="kt">MultiThreadedEventLoopGroup</span><span class="p">(</span><span class="nv">numberOfThreads</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">defer</span> <span class="p">{</span>
        <span class="k">try!</span> <span class="n">group</span><span class="o">.</span><span class="nf">syncShutdownGracefully</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">let</span> <span class="nv">bootstrap</span> <span class="o">=</span> <span class="kt">DatagramBootstrap</span><span class="p">(</span><span class="nv">group</span><span class="p">:</span> <span class="n">group</span><span class="p">)</span>
        <span class="c1">// Enable SO_REUSEADDR.</span>
        <span class="o">.</span><span class="nf">channelOption</span><span class="p">(</span><span class="kt">ChannelOptions</span><span class="o">.</span><span class="nf">socket</span><span class="p">(</span><span class="kt">SocketOptionLevel</span><span class="p">(</span><span class="kt">SOL_SOCKET</span><span class="p">),</span> <span class="kt">SO_REUSEADDR</span><span class="p">),</span> <span class="nv">value</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">.</span><span class="n">channelInitializer</span> <span class="p">{</span> <span class="n">channel</span> <span class="k">in</span>
            <span class="n">channel</span><span class="o">.</span><span class="n">pipeline</span><span class="o">.</span><span class="nf">addHandler</span><span class="p">(</span><span class="kt">MyChannelHandler</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="k">let</span> <span class="nv">channel</span> <span class="o">=</span> <span class="k">try!</span> <span class="n">bootstrap</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">host</span><span class="p">:</span> <span class="s">"127.0.0.1"</span><span class="p">,</span> <span class="nv">port</span><span class="p">:</span> <span class="mi">53</span><span class="p">)</span><span class="o">.</span><span class="nf">wait</span><span class="p">()</span>
    <span class="cm">/* the Channel is now ready to send/receive datagrams */</span>

    <span class="k">try</span> <span class="n">channel</span><span class="o">.</span><span class="n">closeFuture</span><span class="o">.</span><span class="nf">wait</span><span class="p">()</span>  <span class="c1">// Wait until the channel un-binds.</span>
</code></pre>

<p>The <code>DatagramChannel</code> will operate on <code><a href="Structs/AddressedEnvelope.html">AddressedEnvelope&lt;ByteBuffer&gt;</a></code> as inbound and outbound messages.</p>

                        <a href="Classes/DatagramBootstrap.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">DatagramBootstrap</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO20AcceptBackoffHandlerC"></a>
                    <a name="//apple_ref/swift/Class/AcceptBackoffHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO20AcceptBackoffHandlerC">AcceptBackoffHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code> that implements a backoff for a <code>ServerChannel</code> when accept produces an <code><a href="Structs/IOError.html">IOError</a></code>.
These errors are often recoverable by reducing the rate at which we call accept.</p>

                        <a href="Classes/AcceptBackoffHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">AcceptBackoffHandler</span> <span class="p">:</span> <span class="kt"><a href="Typealiases.html#/s:3NIO20ChannelDuplexHandlera">ChannelDuplexHandler</a></span><span class="p">,</span> <span class="kt"><a href="Protocols/RemovableChannelHandler.html">RemovableChannelHandler</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO19BackPressureHandlerC"></a>
                    <a name="//apple_ref/swift/Class/BackPressureHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO19BackPressureHandlerC">BackPressureHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>ChannelHandler implementation which enforces back-pressure by stopping to read from the remote peer when it cannot write back fast enough.
It will start reading again once pending data was written.</p>

                        <a href="Classes/BackPressureHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">BackPressureHandler</span> <span class="p">:</span> <span class="kt"><a href="Typealiases.html#/s:3NIO20ChannelDuplexHandlera">ChannelDuplexHandler</a></span><span class="p">,</span> <span class="kt"><a href="Protocols/RemovableChannelHandler.html">RemovableChannelHandler</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO16IdleStateHandlerC"></a>
                    <a name="//apple_ref/swift/Class/IdleStateHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO16IdleStateHandlerC">IdleStateHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Triggers an IdleStateEvent when a Channel has not performed read, write, or both operation for a while.</p>

                        <a href="Classes/IdleStateHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">IdleStateHandler</span> <span class="p">:</span> <span class="kt"><a href="Typealiases.html#/s:3NIO20ChannelDuplexHandlera">ChannelDuplexHandler</a></span><span class="p">,</span> <span class="kt"><a href="Protocols/RemovableChannelHandler.html">RemovableChannelHandler</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO15ChannelPipelineC"></a>
                    <a name="//apple_ref/swift/Class/ChannelPipeline" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO15ChannelPipelineC">ChannelPipeline</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A list of <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s that handle or intercept inbound events and outbound operations of a
<code><a href="Protocols/Channel.html">Channel</a></code>. <code>ChannelPipeline</code> implements an advanced form of the Intercepting Filter pattern
to give a user full control over how an event is handled and how the <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s in a pipeline
interact with each other.</p>
<h1 id='creation-of-a-pipeline' class='heading'>Creation of a pipeline</h1>

<p>Each <code><a href="Protocols/Channel.html">Channel</a></code> has its own <code>ChannelPipeline</code> and it is created automatically when a new <code><a href="Protocols/Channel.html">Channel</a></code> is created.</p>
<h1 id='how-an-event-flows-in-a-pipeline' class='heading'>How an event flows in a pipeline</h1>

<p>The following diagram describes how I/O events are typically processed by <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s in a <code>ChannelPipeline</code>.
An I/O event is handled by either a <code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code> or a <code><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></code>
and is forwarded to the next handler in the <code>ChannelPipeline</code> by calling the event propagation methods defined in
<code><a href="Classes/ChannelHandlerContext.html">ChannelHandlerContext</a></code>, such as <code>ChannelHandlerContext.fireChannelRead</code> and
<code>ChannelHandlerContext.write</code>.</p>
<pre class="highlight swift"><code>                                                   <span class="kt">I</span><span class="o">/</span><span class="kt">O</span> <span class="kt">Request</span>
                                                   <span class="n">via</span> <span class="p">`</span><span class="nv">Channel</span><span class="p">`</span> <span class="n">or</span>
                                                   <span class="p">`</span><span class="nv">ChannelHandlerContext</span><span class="p">`</span>
                                                     <span class="o">|</span>
 <span class="o">+---------------------------------------------------+---------------+</span>
 <span class="o">|</span>                           <span class="kt">ChannelPipeline</span>         <span class="o">|</span>               <span class="o">|</span>
 <span class="o">|</span>                                <span class="kt">TAIL</span>              <span class="p">\</span><span class="o">|/</span>              <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+---------------------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span> <span class="kt">Inbound</span> <span class="kt">Handler</span>  <span class="kt">N</span>  <span class="o">|</span>            <span class="o">|</span> <span class="kt">Outbound</span> <span class="kt">Handler</span>  <span class="mi">1</span>  <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>              <span class="o">/|</span><span class="p">\</span>                                  <span class="o">|</span>               <span class="o">|</span>
 <span class="o">|</span>               <span class="o">|</span>                                  <span class="p">\</span><span class="o">|/</span>              <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span> <span class="kt">Inbound</span> <span class="kt">Handler</span> <span class="kt">N</span><span class="o">-</span><span class="mi">1</span> <span class="o">|</span>            <span class="o">|</span> <span class="kt">Outbound</span> <span class="kt">Handler</span>  <span class="mi">2</span>  <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>              <span class="o">/|</span><span class="p">\</span>                                  <span class="o">.</span>               <span class="o">|</span>
 <span class="o">|</span>               <span class="o">.</span>                                   <span class="o">.</span>               <span class="o">|</span>
 <span class="o">|</span> <span class="kt">ChannelHandlerContext</span><span class="o">.</span><span class="nf">fireIN_EVT</span><span class="p">()</span> <span class="kt">ChannelHandlerContext</span><span class="o">.</span><span class="kt">OUT_EVT</span><span class="p">()</span><span class="o">|</span>
 <span class="o">|</span>        <span class="p">[</span> <span class="n">method</span> <span class="n">call</span><span class="p">]</span>                       <span class="p">[</span><span class="n">method</span> <span class="n">call</span><span class="p">]</span>         <span class="o">|</span>
 <span class="o">|</span>               <span class="o">.</span>                                   <span class="o">.</span>               <span class="o">|</span>
 <span class="o">|</span>               <span class="o">.</span>                                  <span class="p">\</span><span class="o">|/</span>              <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span> <span class="kt">Inbound</span> <span class="kt">Handler</span>  <span class="mi">2</span>  <span class="o">|</span>            <span class="o">|</span> <span class="kt">Outbound</span> <span class="kt">Handler</span> <span class="kt">M</span><span class="o">-</span><span class="mi">1</span> <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>              <span class="o">/|</span><span class="p">\</span>                                  <span class="o">|</span>               <span class="o">|</span>
 <span class="o">|</span>               <span class="o">|</span>                                  <span class="p">\</span><span class="o">|/</span>              <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">|</span> <span class="kt">Inbound</span> <span class="kt">Handler</span>  <span class="mi">1</span>  <span class="o">|</span>            <span class="o">|</span> <span class="kt">Outbound</span> <span class="kt">Handler</span>  <span class="kt">M</span>  <span class="o">|</span>    <span class="o">|</span>
 <span class="o">|</span>    <span class="o">+----------+----------+</span>            <span class="o">+-----------+----------+</span>    <span class="o">|</span>
 <span class="o">|</span>              <span class="o">/|</span><span class="p">\</span>             <span class="kt">HEAD</span>                 <span class="o">|</span>               <span class="o">|</span>
 <span class="o">+---------------+-----------------------------------+---------------+</span>
                 <span class="o">|</span>                                  <span class="p">\</span><span class="o">|/</span>
 <span class="o">+---------------+-----------------------------------+---------------+</span>
 <span class="o">|</span>               <span class="o">|</span>                                   <span class="o">|</span>               <span class="o">|</span>
 <span class="o">|</span>       <span class="p">[</span> <span class="kt">Socket</span><span class="o">.</span><span class="n">read</span> <span class="p">]</span>                    <span class="p">[</span> <span class="kt">Socket</span><span class="o">.</span><span class="n">write</span> <span class="p">]</span>         <span class="o">|</span>
 <span class="o">|</span>                                                                   <span class="o">|</span>
 <span class="o">|</span>  <span class="kt">SwiftNIO</span> <span class="kt">Internal</span> <span class="kt">I</span><span class="o">/</span><span class="kt">O</span> <span class="kt">Threads</span> <span class="p">(</span><span class="kt">Transport</span> <span class="kt">Implementation</span><span class="p">)</span>         <span class="o">|</span>
 <span class="o">+-------------------------------------------------------------------+</span>
</code></pre>

<p>An inbound event is handled by the inbound handlers in the head-to-tail direction as shown on the left side of the
diagram. An inbound handler usually handles the inbound data generated by the I/O thread on the bottom of the
diagram. The inbound data is often read from a remote peer via the actual input operation such as
<code>Socket.read</code>. If an inbound event goes beyond the tail inbound handler, it is discarded
silently, or logged if it needs your attention.</p>

<p>An outbound event is handled by the outbound handlers in the tail-to-head direction as shown on the right side of the
diagram. An outbound handler usually generates or transforms the outbound traffic such as write requests.
If an outbound event goes beyond the head outbound handler, it is handled by an I/O thread associated with the
<code><a href="Protocols/Channel.html">Channel</a></code>. The I/O thread often performs the actual output operation such as <code>Socket.write</code>.</p>

<p>For example, let us assume that we created the following pipeline:</p>
<pre class="highlight swift"><code><span class="kt">ChannelPipeline</span> <span class="n">p</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">future</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kt">InboundHandlerA</span><span class="p">())</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
  <span class="n">p</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"2"</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kt">InboundHandlerB</span><span class="p">())</span>
<span class="p">}</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
  <span class="n">p</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"3"</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kt">OutboundHandlerA</span><span class="p">())</span>
<span class="p">}</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
  <span class="n">p</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"4"</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kt">OutboundHandlerB</span><span class="p">())</span>
<span class="p">}</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
  <span class="n">p</span><span class="o">.</span><span class="nf">add</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"5"</span><span class="p">,</span> <span class="nv">handler</span><span class="p">:</span> <span class="kt">InboundOutboundHandlerX</span><span class="p">())</span>
<span class="p">}</span>
<span class="c1">// Handle the future as well ....</span>
</code></pre>

<p>In the example above, a class whose name starts with <code>Inbound</code> is an inbound handler.
A class whose name starts with <code>Outbound</code> is an outbound handler.</p>

<p>In the given example configuration, the handler evaluation order is 1, 2, 3, 4, 5 when an event goes inbound.
When an event goes outbound, the order is 5, 4, 3, 2, 1.  On top of this principle, <code>ChannelPipeline</code> skips
the evaluation of certain handlers to shorten the stack depth:</p>

<ul>
<li>3 and 4 don&rsquo;t implement <code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code>, and therefore the actual evaluation order of an inbound event will be: 1, 2, and 5.</li>
<li>1 and 2 don&rsquo;t implement <code><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></code>, and therefore the actual evaluation order of a outbound event will be: 5, 4, and 3.</li>
<li>If 5 implements both <code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code> and <code><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></code>, the evaluation order of an inbound and a outbound event could be 125 and 543 respectively.</li>
</ul>
<h1 id='forwarding-an-event-to-the-next-handler' class='heading'>Forwarding an event to the next handler</h1>

<p>As you might noticed in the diagram above, a handler has to invoke the event propagation methods in
<code><a href="Classes/ChannelHandlerContext.html">ChannelHandlerContext</a></code> to forward an event to its next handler.
Those methods include:</p>

<ul>
<li>Inbound event propagation methods defined in <code><a href="Protocols/ChannelInboundInvoker.html">ChannelInboundInvoker</a></code></li>
<li>Outbound event propagation methods defined in <code><a href="Protocols/ChannelOutboundInvoker.html">ChannelOutboundInvoker</a></code>.</li>
</ul>
<h1 id='building-a-pipeline' class='heading'>Building a pipeline</h1>

<p>A user is supposed to have one or more <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s in a <code>ChannelPipeline</code> to receive I/O events (e.g. read) and
to request I/O operations (e.g. write and close).  For example, a typical server will have the following handlers
in each channel&rsquo;s pipeline, but your mileage may vary depending on the complexity and characteristics of the
protocol and business logic:</p>

<ul>
<li>Protocol Decoder - translates binary data (e.g. <code><a href="Structs/ByteBuffer.html">ByteBuffer</a></code>) into a struct / class</li>
<li>Protocol Encoder - translates a struct / class into binary data (e.g. <code><a href="Structs/ByteBuffer.html">ByteBuffer</a></code>)</li>
<li>Business Logic Handler - performs the actual business logic (e.g. database access)</li>
</ul>
<h1 id='thread-safety' class='heading'>Thread safety</h1>

<p>A <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code> can be added or removed at any time because a <code>ChannelPipeline</code> is thread safe.</p>

                        <a href="Classes/ChannelPipeline.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ChannelPipeline</span> <span class="p">:</span> <span class="kt"><a href="Protocols.html#/s:3NIO14ChannelInvokerP">ChannelInvoker</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO21ChannelHandlerContextC"></a>
                    <a name="//apple_ref/swift/Class/ChannelHandlerContext" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO21ChannelHandlerContextC">ChannelHandlerContext</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Every <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code> has &ndash; when added to a <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> &ndash; a corresponding <code>ChannelHandlerContext</code> which is
the way <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s can interact with other <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s in the pipeline.</p>

<p>Most <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s need to send events through the <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> which they do by calling the respective
method on their <code>ChannelHandlerContext</code>. In fact all the <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code> default implementations just forward
the event using the <code>ChannelHandlerContext</code>.</p>

<p>Many events are instrumental for a <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>&lsquo;s life-cycle and it is therefore very important to send them
at the right point in time. Often, the right behaviour is to react to an event and then forward it to the next
<code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>.</p>

                        <a href="Classes/ChannelHandlerContext.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ChannelHandlerContext</span> <span class="p">:</span> <span class="kt"><a href="Protocols.html#/s:3NIO14ChannelInvokerP">ChannelInvoker</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <div class="task-name-container">
                <a name="/B2MDBuffer%20Helpers"></a>
                <a name="//apple_ref/swift/Section/B2MDBuffer Helpers" class="dashAnchor"></a>
                <a href="#/B2MDBuffer%20Helpers">
                  <h3 class="section-name">B2MDBuffer Helpers</h3>
                </a>
              </div>
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO20ByteToMessageHandlerC"></a>
                    <a name="//apple_ref/swift/Class/ByteToMessageHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO20ByteToMessageHandlerC">ByteToMessageHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A handler which turns a given <code><a href="Protocols/ByteToMessageDecoder.html">ByteToMessageDecoder</a></code> into a <code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code> that can then be added to a
<code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code>.</p>

<p>Most importantly, <code>ByteToMessageHandler</code> handles the tricky buffer management for you and flattens out all
re-entrancy on <code>channelRead</code> that may happen in the <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code>.</p>

                        <a href="Classes/ByteToMessageHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ByteToMessageHandler</span><span class="o">&lt;</span><span class="kt">Decoder</span><span class="o">&gt;</span> <span class="k">where</span> <span class="kt">Decoder</span> <span class="p">:</span> <span class="kt"><a href="Protocols/ByteToMessageDecoder.html">ByteToMessageDecoder</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <div class="task-name-container">
                <a name="/ByteToMessageHandler:%20ChannelInboundHandler"></a>
                <a name="//apple_ref/swift/Section/ByteToMessageHandler: ChannelInboundHandler" class="dashAnchor"></a>
                <a href="#/ByteToMessageHandler:%20ChannelInboundHandler">
                  <h3 class="section-name">ByteToMessageHandler: ChannelInboundHandler</h3>
                </a>
              </div>
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO20MessageToByteHandlerC"></a>
                    <a name="//apple_ref/swift/Class/MessageToByteHandler" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO20MessageToByteHandlerC">MessageToByteHandler</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A handler which turns a given <code><a href="Protocols/MessageToByteEncoder.html">MessageToByteEncoder</a></code> into a <code><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></code> that can then be added to a
<code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code>.</p>

                        <a href="Classes/MessageToByteHandler.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">MessageToByteHandler</span><span class="o">&lt;</span><span class="kt">Encoder</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt"><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></span> <span class="k">where</span> <span class="kt">Encoder</span> <span class="p">:</span> <span class="kt"><a href="Protocols/MessageToByteEncoder.html">MessageToByteEncoder</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO17EmbeddedEventLoopC"></a>
                    <a name="//apple_ref/swift/Class/EmbeddedEventLoop" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO17EmbeddedEventLoopC">EmbeddedEventLoop</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>An <code><a href="Protocols/EventLoop.html">EventLoop</a></code> that is embedded in the current running context with no external
control.</p>

<p>Unlike more complex <code><a href="Protocols/EventLoop.html">EventLoop</a></code>s, such as <code>SelectableEventLoop</code>, the <code>EmbeddedEventLoop</code>
has no proper eventing mechanism. Instead, reads and writes are fully controlled by the
entity that instantiates the <code>EmbeddedEventLoop</code>. This property makes <code>EmbeddedEventLoop</code>
of limited use for many application purposes, but highly valuable for testing and other
kinds of mocking.</p>
<div class="aside aside-warning">
    <p class="aside-title">Warning</p>
    Unlike <code>SelectableEventLoop</code>, <code>EmbeddedEventLoop</code> <strong>is not thread-safe</strong>. This
is because it is intended to be run in the thread that instantiated it. Users are
responsible for ensuring they never call into the <code>EmbeddedEventLoop</code> in an
unsynchronized fashion.

</div>

                        <a href="Classes/EmbeddedEventLoop.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">EmbeddedEventLoop</span> <span class="p">:</span> <span class="kt"><a href="Protocols/EventLoop.html">EventLoop</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO15EmbeddedChannelC"></a>
                    <a name="//apple_ref/swift/Class/EmbeddedChannel" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO15EmbeddedChannelC">EmbeddedChannel</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p><code>EmbeddedChannel</code> is a <code><a href="Protocols/Channel.html">Channel</a></code> implementation that does neither any
actual IO nor has a proper eventing mechanism. The prime use-case for
<code>EmbeddedChannel</code> is in unit tests when you want to feed the inbound events
and check the outbound events manually.</p>

<p>To feed events through an <code>EmbeddedChannel</code>&lsquo;s <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> use
<code>EmbeddedChannel.writeInbound</code> which accepts data of any type. It will then
forward that data through the <code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> and the subsequent
<code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code> will receive it through the usual <code>channelRead</code>
event. The user is responsible for making sure the first
<code><a href="Protocols/ChannelInboundHandler.html">ChannelInboundHandler</a></code> expects data of that type.</p>

<p><code>EmbeddedChannel</code> automatically collects arriving outbound data and makes it
available one-by-one through <code>readOutbound</code>.</p>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    Due to <a href="https://github.com/apple/swift-nio/issues/243">#243</a>
<code>EmbeddedChannel</code> expects outbound data to be of <code><a href="Enums/IOData.html">IOData</a></code> type. This is an
incorrect and unfortunate assumption that will be fixed with the next
major NIO release when we can change the public API again. If you do need
to collect outbound data that is not <code><a href="Enums/IOData.html">IOData</a></code> you can create a custom
<code><a href="Protocols/ChannelOutboundHandler.html">ChannelOutboundHandler</a></code>, insert it at the very beginning of the
<code><a href="Classes/ChannelPipeline.html">ChannelPipeline</a></code> and collect the outbound data there. Just don&rsquo;t forward
it using <code>context.write</code>.

</div>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    <code>EmbeddedChannel</code> is currently only compatible with
<code><a href="Classes/EmbeddedEventLoop.html">EmbeddedEventLoop</a></code>s and cannot be used with <code>SelectableEventLoop</code>s from
for example <code><a href="Classes/MultiThreadedEventLoopGroup.html">MultiThreadedEventLoopGroup</a></code>.

</div>
<div class="aside aside-warning">
    <p class="aside-title">Warning</p>
    Unlike other <code><a href="Protocols/Channel.html">Channel</a></code>s, <code>EmbeddedChannel</code> <strong>is not thread-safe</strong>. This
is because it is intended to be run in the thread that instantiated it. Users are
responsible for ensuring they never call into an <code>EmbeddedChannel</code> in an
unsynchronized fashion. <code><a href="Classes/EmbeddedEventLoop.html">EmbeddedEventLoop</a></code>s notes also apply as
<code>EmbeddedChannel</code> uses an <code><a href="Classes/EmbeddedEventLoop.html">EmbeddedEventLoop</a></code> as its <code><a href="Protocols/EventLoop.html">EventLoop</a></code>.

</div>

                        <a href="Classes/EmbeddedChannel.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">EmbeddedChannel</span> <span class="p">:</span> <span class="kt"><a href="Protocols/Channel.html">Channel</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO12RepeatedTaskC"></a>
                    <a name="//apple_ref/swift/Class/RepeatedTask" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO12RepeatedTaskC">RepeatedTask</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Returned once a task was scheduled to be repeatedly executed on the <code><a href="Protocols/EventLoop.html">EventLoop</a></code>.</p>

<p>A <code>RepeatedTask</code> allows the user to <code>cancel()</code> the repeated scheduling of further tasks.</p>

                        <a href="Classes/RepeatedTask.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">RepeatedTask</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO27MultiThreadedEventLoopGroupC"></a>
                    <a name="//apple_ref/swift/Class/MultiThreadedEventLoopGroup" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO27MultiThreadedEventLoopGroupC">MultiThreadedEventLoopGroup</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>An <code><a href="Protocols/EventLoopGroup.html">EventLoopGroup</a></code> which will create multiple <code><a href="Protocols/EventLoop.html">EventLoop</a></code>s, each tied to its own <code>NIOThread</code>.</p>

<p>The effect of initializing a <code>MultiThreadedEventLoopGroup</code> is to spawn <code>numberOfThreads</code> fresh threads which will
all run their own <code><a href="Protocols/EventLoop.html">EventLoop</a></code>. Those threads will not be shut down until <code>shutdownGracefully</code> or
<code>syncShutdownGracefully</code> is called.</p>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    It&rsquo;s good style to call <code>MultiThreadedEventLoopGroup.shutdownGracefully</code> or
    <code>MultiThreadedEventLoopGroup.syncShutdownGracefully</code> when you no longer need this <code><a href="Protocols/EventLoopGroup.html">EventLoopGroup</a></code>. In
    many cases that is just before your program exits.

</div>
<div class="aside aside-warning">
    <p class="aside-title">Warning</p>
    Unit tests often spawn one <code>MultiThreadedEventLoopGroup</code> per unit test to force isolation between the
       tests. In those cases it&rsquo;s important to shut the <code>MultiThreadedEventLoopGroup</code> down at the end of the
       test. A good place to start a <code>MultiThreadedEventLoopGroup</code> is the <code>setUp</code> method of your <code>XCTestCase</code>
       subclass, a good place to shut it down is the <code>tearDown</code> method.

</div>

                        <a href="Classes/MultiThreadedEventLoopGroup.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">MultiThreadedEventLoopGroup</span> <span class="p">:</span> <span class="kt"><a href="Protocols/EventLoopGroup.html">EventLoopGroup</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO15EventLoopFutureC"></a>
                    <a name="//apple_ref/swift/Class/EventLoopFuture" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO15EventLoopFutureC">EventLoopFuture</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Holder for a result that will be provided later.</p>

<p>Functions that promise to do work asynchronously can return an <code>EventLoopFuture&lt;Value&gt;</code>.
The recipient of such an object can then observe it to be notified when the operation completes.</p>

<p>The provider of a <code>EventLoopFuture&lt;Value&gt;</code> can create and return a placeholder object
before the actual result is available. For example:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">getNetworkData</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">NetworkResponse</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">promise</span> <span class="o">=</span> <span class="n">eventLoop</span><span class="o">.</span><span class="nf">makePromise</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="kt">NetworkResponse</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>
    <span class="n">queue</span><span class="o">.</span><span class="n">async</span> <span class="p">{</span>
        <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="k">do</span> <span class="n">some</span> <span class="n">work</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
        <span class="n">promise</span><span class="o">.</span><span class="nf">succeed</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="k">if</span> <span class="n">it</span> <span class="n">fails</span><span class="p">,</span> <span class="n">instead</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
        <span class="n">promise</span><span class="o">.</span><span class="nf">fail</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">promise</span><span class="o">.</span><span class="n">futureResult</span>
<span class="p">}</span>
</code></pre>

<p>Note that this function returns immediately; the promise object will be given a value
later on. This behaviour is common to Future/Promise implementations in many programming
languages. If you are unfamiliar with this kind of object, the following resources may be
helpful:</p>

<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises">Javascript</a></li>
<li><a href="http://docs.scala-lang.org/overviews/core/futures.html">Scala</a></li>
<li><a href="https://docs.google.com/document/d/10WOZgLQaYNpOrag-eTbUm-JUCCfdyfravZ4qSOQPg1M/edit">Python</a></li>
</ul>

<p>If you receive a <code>EventLoopFuture&lt;Value&gt;</code> from another function, you have a number of options:
The most common operation is to use <code>flatMap()</code> or <code>map()</code> to add a function that will be called
with the eventual result.  Both methods returns a new <code>EventLoopFuture&lt;Value&gt;</code> immediately
that will receive the return value from your function, but they behave differently. If you have
a function that can return synchronously, the <code>map</code> function will transform the result of type
<code>Value</code> to a the new result of type <code>NewValue</code> and return an <code>EventLoopFuture&lt;NewValue&gt;</code>.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">networkData</span> <span class="o">=</span> <span class="nf">getNetworkData</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

<span class="c1">// When network data is received, convert it.</span>
<span class="k">let</span> <span class="nv">processedResult</span><span class="p">:</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">Processed</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">networkData</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="p">(</span><span class="nv">n</span><span class="p">:</span> <span class="kt">NetworkResponse</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Processed</span> <span class="k">in</span>
    <span class="o">...</span> <span class="n">parse</span> <span class="n">network</span> <span class="n">data</span> <span class="o">....</span>
    <span class="k">return</span> <span class="n">processedResult</span>
<span class="p">}</span>
</code></pre>

<p>If however you need to do more asynchronous processing, you can call <code>flatMap()</code>. The return value of the
function passed to <code>flatMap</code> must be a new <code>EventLoopFuture&lt;NewValue&gt;</code> object: the return value of <code>flatMap()</code> is
a new <code>EventLoopFuture&lt;NewValue&gt;</code> that will contain the eventual result of both the original operation and
the subsequent one.</p>
<pre class="highlight swift"><code><span class="c1">// When converted network data is available, begin the database operation.</span>
<span class="k">let</span> <span class="nv">databaseResult</span><span class="p">:</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">DBResult</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">processedResult</span><span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span> <span class="p">(</span><span class="nv">p</span><span class="p">:</span> <span class="kt">Processed</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">DBResult</span><span class="o">&gt;</span> <span class="k">in</span>
    <span class="k">return</span> <span class="nf">someDatabaseOperation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>In essence, future chains created via <code>flatMap()</code> provide a form of data-driven asynchronous programming
that allows you to dynamically declare data dependencies for your various operations.</p>

<p><code>EventLoopFuture</code> chains created via <code>flatMap()</code> are sufficient for most purposes. All of the registered
functions will eventually run in order. If one of those functions throws an error, that error will
bypass the remaining functions. You can use <code>flatMapError()</code> to handle and optionally recover from
errors in the middle of a chain.</p>

<p>At the end of an <code>EventLoopFuture</code> chain, you can use <code>whenSuccess()</code> or <code>whenFailure()</code> to add an
observer callback that will be invoked with the result or error at that point. (Note: If you ever
find yourself invoking <code>promise.succeed()</code> from inside a <code>whenSuccess()</code> callback, you probably should
use <code>flatMap()</code> or <code>cascade(to:)</code> instead.)</p>

<p><code>EventLoopFuture</code> objects are typically obtained by:</p>

<ul>
<li>Using <code>.flatMap()</code> on an existing future to create a new future for the next step in a series of operations.</li>
<li>Initializing an <code>EventLoopFuture</code> that already has a value or an error</li>
</ul>
<h3 id='threading-and-futures' class='heading'>Threading and Futures</h3>

<p>One of the major performance advantages of NIO over something like Node.js or Python’s asyncio is that NIO will
by default run multiple event loops at once, on different threads. As most network protocols do not require
blocking operation, at least in their low level implementations, this provides enormous speedups on machines
with many cores such as most modern servers.</p>

<p>However, it can present a challenge at higher levels of abstraction when coordination between those threads
becomes necessary. This is usually the case whenever the events on one connection (that is, one <code><a href="Protocols/Channel.html">Channel</a></code>) depend
on events on another one. As these <code><a href="Protocols/Channel.html">Channel</a></code>s may be scheduled on different event loops (and so different threads)
care needs to be taken to ensure that communication between the two loops is done in a thread-safe manner that
avoids concurrent mutation of shared state from multiple loops at once.</p>

<p>The main primitives NIO provides for this use are the <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code> and <code>EventLoopFuture</code>. As their names
suggest, these two objects are aware of event loops, and so can help manage the safety and correctness of your
programs. However, understanding the exact semantics of these objects is critical to ensuring the safety of your code.</p>
<h4 id='callbacks' class='heading'>Callbacks</h4>

<p>The most important principle of the <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code> and <code>EventLoopFuture</code> is this: all callbacks registered on
an <code>EventLoopFuture</code> will execute on the thread corresponding to the event loop that created the <code>Future</code>,
<em>regardless</em> of what thread succeeds or fails the corresponding <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code>.</p>

<p>This means that if <em>your code</em> created the <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code>, you can be extremely confident of what thread the
callback will execute on: after all, you held the event loop in hand when you created the <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code>.
However, if your code is handed an <code>EventLoopFuture</code> or <code><a href="Structs/EventLoopPromise.html">EventLoopPromise</a></code>, and you want to register callbacks
on those objects, you cannot be confident that those callbacks will execute on the same <code><a href="Protocols/EventLoop.html">EventLoop</a></code> that your
code does.</p>

<p>This presents a problem: how do you ensure thread-safety when registering callbacks on an arbitrary
<code>EventLoopFuture</code>? The short answer is that when you are holding an <code>EventLoopFuture</code>, you can always obtain a
new <code>EventLoopFuture</code> whose callbacks will execute on your event loop. You do this by calling
<code><a href="Classes/EventLoopFuture.html#/s:3NIO15EventLoopFutureC3hop2toACyxGAA0bC0_p_tF">EventLoopFuture.hop(to:)</a></code>. This function returns a new <code>EventLoopFuture</code> whose callbacks are guaranteed
to fire on the provided event loop. As an added bonus, <code>hopTo</code> will check whether the provided <code>EventLoopFuture</code>
was already scheduled to dispatch on the event loop in question, and avoid doing any work if that was the case.</p>

<p>This means that for any <code>EventLoopFuture</code> that your code did not create itself (via
<code><a href="Structs/EventLoopPromise.html#/s:3NIO16EventLoopPromiseV12futureResultAA0bC6FutureCyxGvp">EventLoopPromise.futureResult</a></code>), use of <code>hopTo</code> is <strong>strongly encouraged</strong> to help guarantee thread-safety. It
should only be elided when thread-safety is provably not needed.</p>

<p>The <q>thread affinity</q> of <code>EventLoopFuture</code>s is critical to writing safe, performant concurrent code without
boilerplate. It allows you to avoid needing to write or use locks in your own code, instead using the natural
synchronization of the <code><a href="Protocols/EventLoop.html">EventLoop</a></code> to manage your thread-safety. In general, if any of your <code><a href="Protocols/ChannelHandler.html">ChannelHandler</a></code>s
or <code>EventLoopFuture</code> callbacks need to invoke a lock (either directly or in the form of <code>DispatchQueue</code>) this
should be considered a code smell worth investigating: the <code><a href="Protocols/EventLoop.html">EventLoop</a></code>-based synchronization guarantees of
<code>EventLoopFuture</code> should be sufficient to guarantee thread-safety.</p>

                        <a href="Classes/EventLoopFuture.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO13NIOFileHandleC"></a>
                    <a name="//apple_ref/swift/Class/NIOFileHandle" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO13NIOFileHandleC">NIOFileHandle</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>NIOFileHandle</code> is a handle to an open file.</p>

<p>When creating a <code>NIOFileHandle</code> it takes ownership of the underlying file descriptor. When a <code>NIOFileHandle</code> is no longer
needed you must <code>close</code> it or take back ownership of the file descriptor using <code>takeDescriptorOwnership</code>.</p>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    <p>One underlying file descriptor should usually be managed by one <code>NIOFileHandle</code> only.</p>

</div>
<div class="aside aside-warning">
    <p class="aside-title">Warning</p>
    <p>Failing to manage the lifetime of a <code>NIOFileHandle</code> correctly will result in undefined behaviour.</p>

</div>
<div class="aside aside-warning">
    <p class="aside-title">Warning</p>
    <p><code>NIOFileHandle</code> objects are not thread-safe and are mutable. They also cannot be fully thread-safe as they refer to a global underlying file descriptor.</p>

</div>

                        <a href="Classes/NIOFileHandle.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">NIOFileHandle</span> <span class="p">:</span> <span class="kt"><a href="Protocols/FileDescriptor.html">FileDescriptor</a></span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO19NIONetworkInterfaceC"></a>
                    <a name="//apple_ref/swift/Class/NIONetworkInterface" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO19NIONetworkInterfaceC">NIONetworkInterface</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A representation of a single network interface on a system.</p>

                        <a href="Classes/NIONetworkInterface.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">NIONetworkInterface</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO13NIOThreadPoolC"></a>
                    <a name="//apple_ref/swift/Class/NIOThreadPool" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO13NIOThreadPoolC">NIOThreadPool</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A thread pool that should be used if some (kernel thread) blocking work
needs to be performed for which no non-blocking API exists.</p>

<p>When using NIO it is crucial not to block any of the <code><a href="Protocols/EventLoop.html">EventLoop</a></code>s as that
leads to slow downs or stalls of arbitrary other work. Unfortunately though
there are tasks that applications need to achieve for which no non-blocking
APIs exist. In those cases <code>NIOThreadPool</code> can be used but should be
treated as a last resort.</p>
<div class="aside aside-note">
    <p class="aside-title">Note</p>
    The prime example for missing non-blocking APIs is file IO on UNIX.
The OS does not provide a usable and truly non-blocking API but with
<code><a href="Structs/NonBlockingFileIO.html">NonBlockingFileIO</a></code> NIO provides a high-level API for file IO that should
be preferred to running blocking file IO system calls directly on
<code>NIOThreadPool</code>. Under the covers <code><a href="Structs/NonBlockingFileIO.html">NonBlockingFileIO</a></code> will use
<code>NIOThreadPool</code> on all currently supported platforms though.

</div>

                        <a href="Classes/NIOThreadPool.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">NIOThreadPool</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3NIO22ThreadSpecificVariableC"></a>
                    <a name="//apple_ref/swift/Class/ThreadSpecificVariable" class="dashAnchor"></a>
                    <a class="token" href="#/s:3NIO22ThreadSpecificVariableC">ThreadSpecificVariable</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>ThreadSpecificVariable</code> is a variable that can be read and set like a normal variable except that it holds
different variables per thread.</p>

<p><code>ThreadSpecificVariable</code> is thread-safe so it can be used with multiple threads at the same time but the value
returned by <code>currentValue</code> is defined per thread.</p>

                        <a href="Classes/ThreadSpecificVariable.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="kt">ThreadSpecificVariable</span><span class="o">&lt;</span><span class="kt">Value</span><span class="o">&gt;</span> <span class="k">where</span> <span class="kt">Value</span> <span class="p">:</span> <span class="kt">AnyObject</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="https://github.com/apple/swift-nio" target="_blank" rel="external">SwiftNIO Team</a>. All rights reserved. (Last updated: 2019-04-15)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
